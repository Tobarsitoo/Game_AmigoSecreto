<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Amigo Secreto - Usuario</title>
    <link href="/css/styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.3/css/dataTables.bootstrap5.css">
    <style>
        .video-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
        }

        .header-content {
            position: relative;
            z-index: 1;
            color: white;
            padding: 100px 0;
        }

        .preferencias {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .preferencias img {
            max-width: 100%;
            height: auto;
        }

        /* table.dataTable {
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        table.dataTable thead th {
            background-color: #007bff;
            color: white;
            text-align: center;
        }

        table.dataTable tbody td {
            text-align: center;
        }

        table.dataTable tbody tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        table.dataTable tbody tr:hover {
            background-color: #e2e2e2;
        } */

        .empty-message {
            text-align: center;
            font-style: italic;
            color: #888;
        }
    </style>
</head>

<body id="page-top">

    <%- include('../partials/navbar'); %>

    <header class="position-relative">
        <video class="video-background" autoplay muted loop>
            <source src="../fiesta.mp4" type="video/mp4">
            Su navegador no soporta la etiqueta de vídeo.
        </video>
        <div class="header-content text-center">
            <h1 class="fw-bolder">Bienvenido, <%= nombre %>!</h1>
            <p class="lead">Este es el juego de <span class="fw-bold text-uppercase text-warning">AMIGO SECRETO</span>, para comenzar agrega tus preferencias:</p>
            <a class="btn btn-lg btn-warning text-dark" href="#preferencias">Agregar preferencias</a>
        </div>
    </header>

    <section id="preferencias">
        <div class="container px-4">
            <div class="row gx-4 justify-content-center">
                <div class="col-lg-8">
                    <h2 class="text-center pb-5">Preferencias</h2>
                    <p class="lead">Estas son tus <span class="fw-bold text-uppercase text-warning">PREFERENCIAS</span>. En este apartado, podrás agregar los dulces y regalos que te gustaría recibir de tu <span class="fw-bold text-uppercase text-primary">AMIGO SECRETO</span>.</p>
                    <div class="row">
                        <div class="col-md-6 preferencias">
                            <img src="../dulce.gif" alt="">
                            <h3 class="text-center">Dulces</h3>
                            <input type="text" id="dulceInput" class="form-control mb-2" placeholder="Agregar dulce">
                            <button id="addDulce" class="btn btn-primary mb-0 text-light">Agregar Dulce</button>
                            <table id="dulceTable" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Dulces</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Aquí se agregarán los dulces -->
                                </tbody>
                            </table>
                        </div>
                        <div class="col-md-6 preferencias">
                            <img src="../regalo.gif" alt="">
                            <h3 class="text-center">Regalos</h3>
                            <input type="text" id="regaloInput" class="form-control mb-2" placeholder="Agregar regalo">
                            <button id="addRegalo" class="btn btn-primary mb-4">Agregar Regalo</button>
                            <table id="regaloTable" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Regalos</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Aquí se agregarán los regalos -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services section-->
    <section class="bg-light" id="services">
        <div class="container px-4">
            <div class="row gx-4 justify-content-center">
                <div class="col-lg-8">
                    <h2>Services we offer</h2>
                    <p class="lead">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aut optio velit inventore, expedita quo laboriosam possimus ea consequatur vitae, doloribus consequuntur ex. Nemo assumenda laborum vel, labore ut velit dignissimos.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact section-->
    <section id="contact">
        <div class="container px-4">
            <div class="row gx-4 justify-content-center">
                <div class="col-lg-8">
                    <h2>Contact us</h2>
                    <p class="lead">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Vero odio fugiat voluptatem dolor, provident officiis, id iusto! Obcaecati incidunt, qui nihil beatae magnam et repudiandae ipsa exercitationem, in, quo totam.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer-->
    <footer class="py-5 bg-dark">
        <div class="container px-4">
            <p class="m-0 text-center text-white">Copyright &copy; Autor: <a href="">Allan Tobar</a> - 2024</p>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.3/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.1.3/js/dataTables.bootstrap5.js"></script>
    <script src="/js/scripts.js"></script>
    <script>
        $(document).ready(function () {
            // Inicializa DataTables
            const dulceTable = $('#dulceTable').DataTable({
                "language": {
                    "emptyTable": "No hay dulces añadidos aún."
                },
                info: false,
                paging: false,
                searching: false
            });

            const regaloTable = $('#regaloTable').DataTable({
                "language": {
                    "emptyTable": "No hay regalos añadidos aún."
                },
                info: false,
                paging: false,
                searching: false
            });

            // Función para agregar dulce
            $('#addDulce').click(function () {
                const dulce = $('#dulceInput').val().trim();
                if (dulce) {
                    $.post('/preferences/dulces', { dulce: dulce }, function (response) {
                        if (response.success) {
                            dulceTable.row.add([dulce]).draw();
                            $('#dulceInput').val('');
                        } else {
                            alert(response.message);
                        }
                    });
                } else {
                    alert('Por favor ingrese un dulce');
                }
            });

            // Función para agregar regalo
            $('#addRegalo').click(function () {
                const regalo = $('#regaloInput').val().trim();
                if (regalo) {
                    $.post('/preferences/regalos', { regalo: regalo }, function (response) {
                        if (response.success) {
                            regaloTable.row.add([regalo]).draw();
                            $('#regaloInput').val('');
                        } else {
                            alert(response.message);
                        }
                    });
                } else {
                    alert('Por favor ingrese un regalo');
                }
            });

            // Función para obtener y mostrar dulces
            $.get('/preferences/dulces', function (response) {
                if (response.success) {
                    if (response.dulces.length > 0) {
                        response.dulces.forEach(dulce => {
                            dulceTable.row.add([dulce.dulce]).draw();
                        });
                    }
                } else {
                    console.error('Error al cargar dulces:', response.message);
                }
            });

            // Función para obtener y mostrar regalos
            $.get('/preferences/regalos', function (response) {
                if (response.success) {
                    if (response.regalos.length > 0) {
                        response.regalos.forEach(regalo => {
                            regaloTable.row.add([regalo.regalo]).draw();
                        });
                    }
                } else {
                    console.error('Error al cargar regalos:', response.message);
                }
            });
        });
    </script>
</body>

</html>